// Copy a file to the output folder subdirectory
static void CopyFileToOutputFolder(string filePath, string outputSubfolder)
{
    try
    {
        // Create the output subdirectory if it doesn't exist
        Directory.CreateDirectory(outputSubfolder);

        // Get the file name from the file path
        string fileName = Path.GetFileName(filePath);

        if (IsZipFile(filePath))
        {
            // Extract the file from the zip to a temporary file
            string tempPath = Path.Combine(outputSubfolder, $"{fileName}.temp");
            using (ZipArchive archive = ZipFile.OpenRead(filePath))
            {
                ZipArchiveEntry entry = archive.GetEntry(fileName);
                if (entry != null)
                {
                    entry.ExtractToFile(tempPath, true);
                }
            }

            // Copy the temporary file to the output subdirectory
            string outputPath = Path.Combine(outputSubfolder, fileName);
            File.Copy(tempPath, outputPath, true);

            // Delete the temporary file
            File.Delete(tempPath);
        }
        else
        {
            // Copy the file to the output subdirectory
            string outputPath = Path.Combine(outputSubfolder, fileName);
            File.Copy(filePath, outputPath, true);
        }
    }
    catch (IOException ex)
    {
        Console.WriteLine($"Error copying file '{filePath}' to output folder: {ex.Message}");
    }
}
